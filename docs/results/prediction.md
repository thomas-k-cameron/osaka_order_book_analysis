# Order Book Modelling 
## Overview
Variables that I use for order book modelling is based on the data I generated by simluating the limit order book using snapshot of ITCH messages.

I will first explain the data that I generated from the LOB reconstruction, then I will move on to feature engineering.

While I explain to you how the variables are generated, I prepared the schema tables on schema table section.

Link: [Schema table](./schema_table.md)

This is auto-generated based on schema file written in toml.

## Products

While Osaka Exchange hosts a *lot* of different future/options contract, I'm going to focus on Nikkei Large/Mini Futures, TOPIX Large/Mini Futures and JGBL Futures, because they are the most widely traded.

Additionally, by restricting the scope of the project it allows me to simlify things.

# Target Variables: Market Price


# Market Depth: *Effective* Best Bid/Ask Spread/Price

Pretty charts you get to find on WSB is most likely to be built based on the price of order execution, e.g. OHLC.  
However, this does not capture the market depth, or market condition outside of order execution.

We are going to call Effective Best Bid/Ask as EBBA. (Writing it all down again and again and again is a pain.) 

EBBA Price is measured as the average price of contracts when you place the order of size $Q$.

For example, say you want to know the EBBA Price of 10 Nikkei 225 Future contracts,
- For bid orders, there are 5 at 29,000 and 10 at 28,000
- For ask orders, there are 5 at 30,000 and 10 at 31,000
- Then, the EBBA Price is: 
- $Effective Bid = (5 * 29,000 + 5 * 28,000) \div 10 = 28,500$.
- $Effective Ask = (5 * 30,000 + 5 * 31,000) \div 10 = 30,500$.
- $Effective Spread = Effective Ask - Effective Bid = 20,000$

While, Q can be any positive integer, we only have finite computing resources, and I honestly don't think that $Q = 11$ and $Q = 10$ would make a whole lot of difference.

I decided to prepare dataset with the following variations:

$$Q = \{1, 100, 500, 1000, 2000, 5000\}$$

$Q = 1$ just means Best Bid/Ask.

Glancing at a EBBA Price 5000 chart of Nikkei Mini futures, I can spot a moment where bid price started to increase following an ask price hike.

Here are some senarios where I think that this measurement could help us understand the market:

1. Massive cancellation
   
   There could be a some kind of economic news leads to significant price change; I think it is possible that traders who happends to be quick enough can cancel all their maker orders.

# Market Depth by Order Speed


# Executions: Tick by tick data

According to Optiver's kaggle competition notebook, *volume* was the most important metrics in predicting the market move.

So, we definately want to include trading volume into our model.

# Options: Greeks

You can't rely on execution price when it comes to options since individual option products are less frequently traded; Well, likely we've got 

# Order Activity: Pieces of information that suppliment the existing data

Thanks to our dataset, we can analyze the market order-by-order.  

We previously learned that execution rate greatly differs depending on the *speed* of the order.



## Market Depth
We are going to measure 
